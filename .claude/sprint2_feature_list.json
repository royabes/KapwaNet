{
  "sprint": 2,
  "name": "Core Community Features",
  "description": "Enable real bayanihan activity and sharing. Full help request, item sharing, messaging, and moderation flows.",
  "success_criteria": [
    "Full help request -> match -> complete flow works",
    "Item sharing with reservation works",
    "Messages persist and display in threads",
    "Reports visible to moderators",
    "Moderation actions logged and enforced",
    "All queries filtered by org_id"
  ],
  "features": [
    {
      "id": "S2-A1",
      "epic": "S2-A",
      "category": "backend",
      "description": "Membership model",
      "steps": [
        "Create Membership model (user <-> org <-> role)",
        "Define roles: org_admin, moderator, member",
        "Define status: active, suspended, left",
        "Create OrgMembershipPermission class",
        "Add membership check to all org-scoped endpoints"
      ],
      "passes": true,
      "acceptance_criteria": [
        "Membership model with user, org, role, status",
        "Unique constraint on (org_id, user_id)",
        "Roles enforced on API endpoints",
        "Suspended users blocked from actions",
        "Permission class reusable across views"
      ],
      "estimated_complexity": "medium",
      "dependencies": []
    },
    {
      "id": "S2-A2",
      "epic": "S2-A",
      "category": "backend",
      "description": "Invite flow",
      "steps": [
        "Create Invite model with token and expiry",
        "Create invite generation endpoint (admin only)",
        "Create invite acceptance endpoint",
        "Send invite email (or return invite link)",
        "User joins org with assigned role on accept"
      ],
      "passes": true,
      "acceptance_criteria": [
        "Invite model with token, role, expires_at",
        "Invite created for specific email and role",
        "Invite link can be used once",
        "Expired invites rejected",
        "User gets correct role on accept"
      ],
      "estimated_complexity": "medium",
      "dependencies": ["S2-A1"]
    },
    {
      "id": "S2-B1",
      "epic": "S2-B",
      "category": "backend",
      "description": "Help post models",
      "steps": [
        "Create HelpPost model with type (request/offer)",
        "Add fields: category, title, description, urgency",
        "Add status flow: open, matched, completed, cancelled",
        "Create HelpPost serializer and viewset",
        "Add endpoints: list, create, update"
      ],
      "passes": true,
      "acceptance_criteria": [
        "HelpPost model with all required fields",
        "org_id filter on all queries",
        "Status transitions validated",
        "CRUD endpoints work correctly",
        "Only author can update their post"
      ],
      "estimated_complexity": "medium",
      "dependencies": ["S2-A1"]
    },
    {
      "id": "S2-B2",
      "epic": "S2-B",
      "category": "backend",
      "description": "Matching flow",
      "steps": [
        "Create HelpMatch model",
        "Add express-interest endpoint",
        "Add accept-match endpoint",
        "Create message thread on match accepted",
        "Update HelpPost status on match"
      ],
      "passes": true,
      "acceptance_criteria": [
        "HelpMatch links helper to requester",
        "Interest can be expressed via API",
        "Match accepted creates thread",
        "HelpPost status changes to matched",
        "Multiple interests allowed before accept"
      ],
      "estimated_complexity": "high",
      "dependencies": ["S2-B1", "S2-D1"]
    },
    {
      "id": "S2-C1",
      "epic": "S2-C",
      "category": "backend",
      "description": "Item post models",
      "steps": [
        "Create ItemPost model with type (offer/request)",
        "Add food safety fields: expiry, allergens, storage",
        "Add photos JSONField",
        "Add status: available, reserved, completed, cancelled",
        "Create ItemPost serializer and viewset"
      ],
      "passes": true,
      "acceptance_criteria": [
        "ItemPost model with all required fields",
        "Food safety fields enforced for food category",
        "Photos stored as JSON array",
        "CRUD endpoints work correctly",
        "org_id filter on all queries"
      ],
      "estimated_complexity": "medium",
      "dependencies": ["S2-A1"]
    },
    {
      "id": "S2-C2",
      "epic": "S2-C",
      "category": "backend",
      "description": "Reservation flow",
      "steps": [
        "Create ItemReservation model",
        "Add reserve endpoint",
        "Add approve-reservation endpoint (owner)",
        "Add confirm-pickup endpoint",
        "Update ItemPost status on reservation"
      ],
      "passes": true,
      "acceptance_criteria": [
        "Reservation links requester to item",
        "Reserve updates item to reserved status",
        "Owner can approve/reject reservation",
        "Pickup confirmation completes flow",
        "Thread created for communication"
      ],
      "estimated_complexity": "high",
      "dependencies": ["S2-C1", "S2-D1"]
    },
    {
      "id": "S2-D1",
      "epic": "S2-D",
      "category": "backend",
      "description": "Thread model",
      "steps": [
        "Create Thread model with type and ref_id",
        "Create Message model with sender and body",
        "Add system message type for automated messages",
        "Create thread endpoints: list, get messages",
        "Create message send endpoint"
      ],
      "passes": true,
      "acceptance_criteria": [
        "Thread links to help_match or item_reservation",
        "Messages persist in thread",
        "System messages for status changes",
        "Only thread participants can send messages",
        "org_id filter on all queries"
      ],
      "estimated_complexity": "medium",
      "dependencies": ["S2-A1"]
    },
    {
      "id": "S2-E1",
      "epic": "S2-E",
      "category": "backend",
      "description": "Reporting system",
      "steps": [
        "Create Report model with target_type and target_id",
        "Add reason_code and details fields",
        "Add status: open, reviewed, closed",
        "Create report submission endpoint",
        "Add report list endpoint (moderators only)"
      ],
      "passes": true,
      "acceptance_criteria": [
        "Report can target user, help_post, item_post, message",
        "Any member can submit report",
        "Reports visible to moderators",
        "Report status can be updated",
        "org_id filter on all queries"
      ],
      "estimated_complexity": "medium",
      "dependencies": ["S2-A1"]
    },
    {
      "id": "S2-E2",
      "epic": "S2-E",
      "category": "backend",
      "description": "Moderator actions",
      "steps": [
        "Create ModerationAction model",
        "Add action types: warn, remove, suspend, ban",
        "Create moderation action endpoint (moderators only)",
        "Enforce actions (suspend user, remove content)",
        "Log all actions with moderator and notes"
      ],
      "passes": true,
      "acceptance_criteria": [
        "Actions create audit log entry",
        "Suspend action updates membership status",
        "Remove action hides content",
        "Ban prevents future membership",
        "Actions logged with moderator ID"
      ],
      "estimated_complexity": "high",
      "dependencies": ["S2-E1", "S2-A1"]
    }
  ]
}
